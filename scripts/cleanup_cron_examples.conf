# DSS SCD Subscription Cleanup Cron Configuration
# 
# This file provides example cron configurations for regular cleanup of expired
# SCD subscriptions to prevent performance degradation.
#
# Add these to your system crontab with: crontab -e

# Run cleanup check every 6 hours (dry run to monitor what would be cleaned)
0 */6 * * * /path/to/dss/scripts/cleanup_subscriptions.sh

# Run actual cleanup daily at 2 AM (when traffic is typically low)
0 2 * * * DRY_RUN=false /path/to/dss/scripts/cleanup_subscriptions.sh

# Weekly comprehensive cleanup with more aggressive TTL (Sundays at 3 AM)
0 3 * * 0 DRY_RUN=false SCD_TTL=168h /path/to/dss/scripts/cleanup_subscriptions.sh

# Alternative: Run cleanup every 4 hours with shorter TTL for high-traffic systems
0 */4 * * * DRY_RUN=false SCD_TTL=720h /path/to/dss/scripts/cleanup_subscriptions.sh

# Performance monitoring: Check subscription table size daily
0 1 * * * echo "SELECT COUNT(*) as subscription_count FROM scd_subscriptions;" | psql -h localhost -d dss -t | logger -t dss-stats

# Example environment-specific configurations:

# Development environment (more frequent cleanup)
# 0 */2 * * * DRY_RUN=false SCD_TTL=24h /path/to/dss/scripts/cleanup_subscriptions.sh

# Production environment (conservative cleanup) 
# 0 3 * * * DRY_RUN=false SCD_TTL=2688h /path/to/dss/scripts/cleanup_subscriptions.sh

# High-traffic environment (more aggressive cleanup)
# 0 */3 * * * DRY_RUN=false SCD_TTL=168h /path/to/dss/scripts/cleanup_subscriptions.sh